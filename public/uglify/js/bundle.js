"use strict";function GetRequest(e,t){var n=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2];void 0!=t?xhr.open("GET",e+t):xhr.open("GET",e),xhr.send(null),xhr.onload=function(){return n(xhr.status,xhr.responseText)}}function PostRequest(e,t,n){var o=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3];t=JSON.stringify(t),xhr.open("POST",e),xhr.setRequestHeader("Content-Type",n),xhr.send(t),xhr.onload=function(){return o(xhr.status,xhr.responseText)}}function GetCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}function DeleteCookies(){console.log("this is running");for(var e="expires=Thu, 01 Jan 1970 00:00:00 GMT;",t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].split("=")[0];document.cookie=o+"=;"+e}}function InitMap(){festivalMap=new google.maps.Map(document.getElementById("festivals-map"),{center:{lat:39.244785,lng:-105.511852},zoom:8})}function FestivalsReady(){GetRequest("/getFestivals",void 0,function(e,t){if(200==e)for(var n=JSON.parse(t),o=n.events,i=document.getElementById("festivals"),l=0;l<o.length;l++){var s=document.createElement("div"),r=document.createElement("li"),a=document.createElement("h1"),u=document.createElement("p");a.textContent=o[l].title,u.textContent=o[l].location,r.appendChild(a),r.appendChild(u),s.appendChild(r),"N/A"!=o[l].location&&(marker.push(CreateMarker(o[l])),s.setAttribute("value",o[l]._id),s.setAttribute("id",l),s.setAttribute("onmouseover","OpenInfoWindow( this.getAttribute( 'value' ), this.getAttribute( 'id' ) )")),i.appendChild(s)}})}function OpenInfoWindow(e,t){null!=previousID&&(document.getElementById(previousID).style.color="#000000"),previousID=t,document.getElementById(t).style.color="#872d2e";for(var n=0;n<marker.length;n++)if(e==marker[n]._id){google.maps.event.trigger(marker[n],"click");break}}function CreateMarker(e){var t=new google.maps.Marker({map:festivalMap,position:new google.maps.LatLng(e.latitude,e.longitude)});t._id=e._id;var n="<h3>"+e.title+"</h3><p> <strong>Date:</strong> "+e.date+"</p> <p><strong>Location:</strong> "+e.location+"</p><a target='_blank' href = '"+e.url+"'> More Info </a>";return t.infoWindow=new google.maps.InfoWindow({content:n}),google.maps.event.addListener(t,"click",function(){lastMarker&&lastMarker.infoWindow.close(),lastMarker=t,t.infoWindow.open(festivalMap,t)}),t}function Login(){var e={email:null,password:null};e.email=document.getElementById("email").value,e.password=document.getElementById("password").value,PostRequest("/auth/login",e,"application/json",function(e,t){if(200==e){var n=new Date(Date.now());n.setHours(n.getHours()+1);var o=JSON.parse(t);for(var i in o)document.cookie=i+"="+o[i]+";expires="+n.toUTCString()+";";console.log(GetCookie("username")),window.open("/user/"+t.username,"_parent")}else console.log("error")})}function IsLoggedIn(){GetRequest("/api/me",void 0,function(e,t){console.log("testing "+e),200==e&&(document.getElementById("logout-button").style.display="inline-block")})}function Home(){GetRequest("/api/me",void 0,function(e,t){var n=JSON.parse(t);200==e?(document.getElementById("logout-button").style.display="inline-block",window.open("/user/"+n.username,"_parent")):window.open("/","_parent")})}function Logout(){DeleteCookies(),window.open("/auth/logout","_parent")}function SubmitRecipe(){var e={alias:null,description:null,category:null,instructions:null};e.alias=document.getElementById("alias").value,e.description=document.getElementById("description").value,e.category=document.getElementById("beer-type-selection").value,e.instructions=document.getElementById("instructions").value,PostRequest("/createrecipe",e,"application/json",function(e,t){200!=e?(document.getElementsByClassName("message")[0].style.color="red",document.getElementsByClassName("message")[0].innerHTML=t):(document.getElementsByClassName("message")[0].style.color="green",document.getElementsByClassName("message")[0].innerHTML=t)})}function RecipesReady(){GetRequest("/getallbeertypes",void 0,function(e,t){if(200==e){beerList=JSON.parse(t);for(var n=document.getElementById("beers"),o=document.createDocumentFragment(),i=0;i<beerList.length;i++){var l=document.createElement("li"),s=document.createElement("BUTTON");l.textContent=beerList[i].alias,s.appendChild(l),s.setAttribute("value",i),s.setAttribute("name",beerList[i].alias),s.setAttribute("onclick","MoreInfo( this.getAttribute( 'value' ) )"),s.className="beer-buttons",o.appendChild(s)}n.appendChild(o)}else console.log(beerList.message)})}function MoreInfo(e){GetRequest("/beer/",beerList[e].alias,function(t,n){if(console.log(n.length),200==t){document.getElementById("user-recipes").innerHTML="";var o=document.getElementById("user-recipes"),i=document.createDocumentFragment(),l=n;console.log(l),document.getElementById("title").textContent=beerList[e].alias,document.getElementById("about").textContent=beerList[e].about,document.getElementById("abv").textContent=beerList[e].abv;for(var s=0;s<l.length;s++){var r=document.createElement("button"),a=document.createElement("li");a.textContent=l[s].alias,r.appendChild(a),r.className="recipe-buttons",i.appendChild(r)}o.appendChild(i),document.getElementById("beer-list").style.display="none",document.getElementById("recipes").style.display="block"}})}function CloseBeerWindow(){document.getElementById("beer-list").style.display="inline-block",document.getElementById("recipes").style.display="none"}function SearchBeerList(e){if(""!=e)for(var t=0;t<beerList.length;t++){var n=beerList[t].alias.toLowerCase(),o=e.toLowerCase();n.includes(o)?"none"==document.getElementById("beers").children[t].style.display&&(document.getElementById("beers").children[t].style.display="inline-block"):document.getElementById("beers").children[t].style.display="none"}else if(""==e)for(var i=0;i<beerList.length;i++)document.getElementById("beers").children[i].style.display="inline-block"}function UserReady(){GetRequest("/api/me",void 0,function(e,t){200===e&&(user=JSON.parse(t),document.getElementById("username").innerHTML="Welcome back, "+user.username)})}var xhr=new XMLHttpRequest,festivalMap,lastMarker,marker=[],previousID;document.getElementById("navigation-bar").innerHTML="<ul><li><button onclick='Home();' id='home-link'>Home</button></li><li><a id='recipes-link' href='/recipes'>Recipes</a></li><li><a id='festivals-link' href='/festivals'>Festivals</a></li></ul>",document.addEventListener("DOMContentLoaded",function(e){GetRequest("/recipes/getallbeertypes",void 0,function(e,t){if(200===e){var n=JSON.parse(t),o=document.getElementById("beer-type-selection"),i=document.createElement("option");i.innerHTML="-- Select One --",i.value=null,o.appendChild(i);for(var l=0;l<n.length;l++){var s=document.createElement("option");s.innerHTML=n[l].alias,s.value=n[l].alias,o.appendChild(s)}}})});var beerList=[],search="",user={};